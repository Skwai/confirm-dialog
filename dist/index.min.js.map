{"version":3,"file":"index.min.js","sources":["../src/index.js"],"sourcesContent":["const DEFAULTS = {\n  cancelLabel: 'Cancel',\n  canCancel: true,\n  className: 'ConfirmDialog',\n  confirmLabel: 'Confirm',\n  message: null,\n  onCancel: () => {},\n  onConfirm: () => {},\n  parent: document.body,\n  title: 'Please Confirm',\n};\n\nconst ESCAPE_KEYCODE = 27;\n\nexport default class ConfirmDialog {\n  constructor(args) {\n    this.opts = Object.assign({}, DEFAULTS, args);\n    if (!(this.opts.parent instanceof Node)) {\n      throw Error('`parent` is not a valid `Node`');\n    }\n    Object.assign(this, {\n      handleConfirm: this.handleConfirm.bind(this),\n      handleCancel: this.handleCancel.bind(this),\n      handleEscape: this.handleEscape.bind(this),\n    });\n    this.render();\n  }\n\n  render() {\n    if (this.element) {\n      throw Error('Cannot render, `element` already exists');\n    }    \n    this.element = document.createElement('div');\n    this.element.classList.add(this.opts.className);\n    this.element.innerHTML = this.template(this.opts);\n    document.body.appendChild(this.element);\n    this.bindListeners();\n  }\n\n  destroy() {\n    this.unbindListeners();\n    if (this.element instanceof Node) {\n      this.element.parentNode.removeChild(this.element);\n      delete this.element;\n    }\n  }\n\n  handleEscape(ev) {\n    if (ev.keyCode === ESCAPE_KEYCODE) {\n      this.handleCancel(ev);\n    }\n  }\n\n  bindListeners() {\n    const { element: el } = this;\n    const { canCancel } = this.opts;\n    if (canCancel) {\n      el.addEventListener('click', (ev) => {\n        if (ev.target.isSameNode(el)) {\n          this.handleCancel();\n        }\n      });\n      window.addEventListener('keyup', this.handleEscape);\n    }\n  }\n\n  unbindListeners() {\n    window.removeEventListener('keyup', this.handleEscape);\n  }\n\n  async handleCancel(ev) {\n    await this.onCancel(ev);\n    this.destroy();\n  }\n\n  async handleConfirm(ev) {\n    await this.onConfirm(ev);\n    this.destroy();\n  }\n\n  template({\n    canCancel,\n    cancelLabel,\n    className: cn,\n    confirmLabel,\n    message,\n    title,\n  }) {\n    return `\n      <div\n        class=\"${cn}__Content\"\n        role=\"alertdialog\"\n        aria-hidden=\"false\"\n        aria-labelledby=\"\"\n        aria-describedby=\"\"\n      >\n        <header class=\"${cn}__Header\">\n          <h4 class=\"${cn}__Title\">${title}</h4>\n        </header>\n        ${message ? `<div class=\"${cn}__Message\">${message}</div>` : ''}\n        <footer class=\"${cn}__Actions\">\n          ${confirmLabel ? `<button type=\"button\" class=\"${cn}__Confirm\">${confirmLabel}</button>` : ''}\n          ${canCancel ? `<button type=\"button\" class=\"${cn}__Cancel\">${cancelLabel}</button>` : ''}\n        </footer>\n      </div>\n    `;\n  }\n}\n"],"names":["DEFAULTS","document","body","ESCAPE_KEYCODE","ConfirmDialog","args","opts","Object","assign","this","parent","Node","Error","handleConfirm","bind","handleCancel","handleEscape","render","element","createElement","classList","add","className","innerHTML","template","appendChild","bindListeners","unbindListeners","parentNode","removeChild","ev","keyCode","el","canCancel","addEventListener","target","isSameNode","removeEventListener","_this2","onCancel","destroy","_this3","onConfirm","cancelLabel","cn","confirmLabel","message","title"],"mappings":";;;;;;4XAAMA,sBACS,oBACF,YACA,6BACG,kBACL,cACC,uBACC,oBACHC,SAASC,WACV,kBAGHC,eAAiB,GAEFC,oCACPC,kCACLC,KAAOC,OAAOC,UAAWR,SAAUK,KAClCI,KAAKH,KAAKI,iBAAkBC,YAC1BC,OAAM,yCAEPJ,OAAOC,oBACGA,KAAKI,cAAcC,KAAKL,mBACzBA,KAAKM,aAAaD,KAAKL,mBACvBA,KAAKO,aAAaF,KAAKL,aAElCQ,iEAIDR,KAAKS,aACDN,OAAM,gDAETM,QAAUjB,SAASkB,cAAc,YACjCD,QAAQE,UAAUC,IAAIZ,KAAKH,KAAKgB,gBAChCJ,QAAQK,UAAYd,KAAKe,SAASf,KAAKH,eACnCJ,KAAKuB,YAAYhB,KAAKS,cAC1BQ,uDAIAC,kBACDlB,KAAKS,kBAAmBP,aACrBO,QAAQU,WAAWC,YAAYpB,KAAKS,eAClCT,MAAKS,8CAIHY,GACPA,EAAGC,UAAY5B,qBACZY,aAAae,sDAKHE,EAAOvB,KAAhBS,OACcT,MAAKH,KAAnB2B,cAEHC,iBAAiB,QAAS,SAACJ,GACxBA,EAAGK,OAAOC,WAAWJ,MAClBjB,wBAGFmB,iBAAiB,QAASzB,KAAKO,gEAKjCqB,oBAAoB,QAAS5B,KAAKO,mDAGxBc,6DACXQ,GAAKC,SAAST,uBACfU,kDAGaV,6DACZW,GAAKC,UAAUZ,uBAChBU,mDAILP,KAAAA,UACAU,IAAAA,YACWC,IAAXtB,UACAuB,IAAAA,aACAC,IAAAA,8CAKaF,mKAMQA,sCACFA,gBAXnBG,4CAaMD,iBAAyBF,gBAAgBE,WAAkB,gCAC5CF,6BACbC,kCAA+CD,gBAAgBC,cAA0B,oBACzFZ,kCAA4CW,eAAeD,cAAyB"}